---
layout: post
title: C语言传参中的传值和传引用
categories: [编程, C]
tags: [传参]
---


> 变量是什么？变量是一个符号，代表一个内存地址，变量的值则是对应内存地址中存储的数据。也就是说一个变量和一个内存地址编号同时指向了一个具体的内存地址，那为什么不直接用地址编号而要用变量呢？因为内存地址是在程序运行中动态分配的，编译期是无法知道的

#### 1. 关于指针

复习一下`C`语言中的指针:
* 定义一个指针变量用`*`，例如`int *p = &i;`表示定义了一个指针型变量`p`，其值为另一变量`i`的地址
* `&`符号为取地址操作，`&i`表示取变量`i`的内存地址
* 作为一个变量，指针和普通变量相同，都是代表一个内存地址，该地址中存放的是变量的值，唯一不同的是指针里存放的是一个内存地址(形如`0xffffffff`)
* 在操作上看`*p`表示取`p`变量的值(一个内存地址)所对应的内存中的数据

#### 2. 测试代码

```c++
//传值
void test1(int x, int y)
{
        int tmp = x;
        x = y;
        y = tmp;
}
//传地址，本质上也是传值(和java中传对象类似)
void test2(int *px, int *py)
{
        int tmp = *px;
        *px = *py;
        *py = tmp;
}

//传引用是C++的语法，需要使用g++编译
void test3(int &x, int &y)
{
   int tmp=x;
   x=y;
   y=tmp;
}

int main(void)
{
        int a = 1, b=2;
        test1(a, b);
        printf("%d,%d\n", a, b);//1,2

        a = 1, b=2;
        test2(&a, &b);
        printf("%d,%d\n", a, b);//2,1

        a = 1, b=2;
        test3(a, b);
        printf("%d,%d\n", a, b);//2,1
}
```

* `test1`是传值即赋值操作`x=a, y=b;`赋值操作是在`x`变量代表的内存中写入`a`的值，这个值是一个拷贝，所以对`x`和`y`变量的再次赋值不会影响原变量`ab`
* `test2`是传地址(实质上也是传值)，因为地址也是值，这里把`ab`的地址赋值给了指针变量`px`,`py`。如此`*px`和`a`所指向的内存是同一段，所以对`*px`的再次赋值会同时改变`a`
* `test3`是传引用，传引用是`c++`的语法，使用符号`&`来定义。`test3`内的`x`和`a`是同一个变量，代表同一个内存地址，所以对`x`的赋值也会改变`a`